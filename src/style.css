:root {
    /* ══ PRIMITIVES ══ */

    /* ── Grays ── */
    --gray-950: #0e0e10;
    --gray-900: #1a1a1f;
    --gray-850: #242429;
    --gray-800: #2e2e35;
    --gray-500: #9a9a9e;
    --gray-200: #e8e6e3;

    /* ── Amber ── */
    --amber-500: #d4943a;
    --amber-600: #b37a25;

    /* ── Teal ── */
    --teal-500: #38b2a3;
    --teal-600: #268079;

    /* ── Indigo ── */
    --indigo-400: #7b8cff;
    --indigo-600: #5563c4;

    /* ── Red ── */
    --red-500: #d44a2a;

    /* ── Color Channels (for rgba composition) ── */
    --rgb-white: 255, 255, 255;
    --rgb-black: 0, 0, 0;
    --rgb-bg: 14, 14, 16;
    --rgb-amber-500: 212, 148, 58;
    --rgb-teal-500: 56, 178, 163;
    --rgb-red-500: 212, 74, 42;
    --rgb-green-500: 46, 204, 113;

    /* ══ SEMANTIC TOKENS ══ */

    /* ── Background & Surface ── */
    --color-bg: var(--gray-950);
    --color-surface: var(--gray-900);
    --color-surface-raised: var(--gray-850);

    /* ── Text ── */
    --color-text: var(--gray-200);
    --color-text-muted: var(--gray-500);
    --color-text-inverse: var(--gray-950);

    /* ── Work Mode (warm amber) ── */
    --color-work: var(--amber-500);
    --color-work-dim: var(--amber-600);
    --color-work-glow: rgba(var(--rgb-amber-500), 0.25);

    /* ── Break Mode (blue-green) ── */
    --color-break: var(--teal-500);
    --color-break-dim: var(--teal-600);
    --color-break-glow: rgba(var(--rgb-teal-500), 0.25);

    /* ── Accent / Interactive ── */
    --color-accent: var(--indigo-400);
    --color-accent-dim: var(--indigo-600);

    /* ── Semantic ── */
    --color-danger: var(--red-500);
    --color-success: var(--teal-500);

    /* ── Border ── */
    --color-border: var(--gray-800);
    --color-border-focus: var(--indigo-400);

    /* ── On-Fill (foreground over hourglass gradient) ── */
    --color-on-fill: rgba(var(--rgb-white), 1);
    --color-on-fill-medium: rgba(var(--rgb-white), 0.6);
    --color-on-fill-muted: rgba(var(--rgb-white), 0.35);
    --color-on-fill-subtle: rgba(var(--rgb-white), 0.3);

    /* ── Overlay (settings panel) ── */
    --color-overlay-bg: rgba(var(--rgb-bg), 0.85);
    --color-overlay-border: rgba(var(--rgb-white), 0.1);

    /* ── Hint (coachmarks, subtle UI) ── */
    --color-hint: rgba(var(--rgb-white), 0.25);
    --color-hint-strong: rgba(var(--rgb-white), 0.35);

    /* ── Effects ── */
    --shadow-timer: 0 2px 20px rgba(var(--rgb-black), 0.5);
    --filter-dot-active: drop-shadow(0 0 6px rgba(var(--rgb-white), 0.5));

    /* ── Spacing Scale ── */
    --space-xs: 4px;
    --space-sm: 8px;
    --space-md: 16px;
    --space-lg: 24px;
    --space-xl: 40px;

    /* ── Typography: Font Families ── */
    --font-body: 'Overpass', 'Segoe UI', system-ui, sans-serif;
    --font-mono: 'Overpass Mono', 'Fira Code', 'Courier New', monospace;

    /* ── Typography: Font Sizes ── */
    --text-2xs: 0.6875rem; /* 11px */
    --text-xs: 0.75rem; /* 12px */
    --text-sm: 0.875rem; /* 14px */
    --text-base: 1rem; /* 16px */
    --text-lg: 1.25rem; /* 20px */
    --text-xl: 1.5rem; /* 24px */
    --text-2xl: 2rem; /* 32px */
    --text-timer: 4.5rem; /* 72px — main countdown display */

    /* ── Icon Sizes ── */
    --icon-sm: 14px;
    --icon-md: 22px;

    /* ── Typography: Font Weights ── */
    --weight-medium: 500;
    --weight-semibold: 600;
    --weight-bold: 700;

    /* ── Typography: Line Heights ── */
    --leading-tight: 1.2;
    --leading-normal: 1.5;
    --leading-relaxed: 1.75;

    /* ── Border Radius ── */
    --radius-sm: 4px;
    --radius-md: 8px;
    --radius-lg: 12px;
    --radius-xl: 16px;
    --radius-full: 9999px;
}

/* ── Base ── */
*,
*::before,
*::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: var(--font-body);
    background-color: var(--color-bg);
    color: var(--color-text);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

#app {
    display: flex;
    flex-direction: column;
    flex: 1;
    position: relative;
    z-index: 1;
}

/* ── Top Bar ── */
.top-bar {
    position: relative;
    background-color: var(--color-bg);
    z-index: 2;
}

/* ── App Header ── */
.app-header {
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    align-items: center;
    padding: var(--space-md) var(--space-lg);
}

.app-title {
    font-size: var(--text-sm);
    font-weight: var(--weight-bold);
    color: var(--color-text-muted);
    text-transform: uppercase;
    letter-spacing: 0.1em;
    transition: color 0.3s;
}

.app-header-left {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
}

.settings-saved-msg {
    font-size: var(--text-xs);
    color: var(--color-success);
    opacity: 0;
    transition: opacity 0.3s;
}

.settings-saved-msg--visible {
    opacity: 1;
}

.app-header-right {
    display: flex;
    justify-content: flex-end;
}

/* ── Main ── */
.main {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--space-xl);
    position: relative;
    overflow: hidden;
    --fill-color: var(--color-work);
    --fill-pct: 1;
}

/* ── Hourglass Fill ── */
.main::before {
    content: '';
    position: absolute;
    inset: 0;
    z-index: 0;
    background: linear-gradient(to bottom,
            color-mix(in srgb, var(--fill-color), white 8%) 0%,
            var(--fill-color) 40%,
            color-mix(in srgb, var(--fill-color), black 12%) 100%);
    transform: scaleY(var(--fill-pct, 1));
    transform-origin: bottom center;
    transition: transform 1s linear, background 0.4s ease, opacity 0.3s ease;
    will-change: transform;
    pointer-events: none;
}

.main--paused::before {
    opacity: 0.35;
    animation: pause-breathe 3s ease-in-out infinite;
}

.main.hourglass-refill::before {
    transition: background 0.8s ease;
}

/* ── Session Completion Flash ── */
@keyframes completion-flash {
    0% { opacity: 1; filter: brightness(1); }
    30% { opacity: 1; filter: brightness(1.8); }
    100% { opacity: 1; filter: brightness(1); }
}

.main--celebrating::before {
    animation: completion-flash 0.5s ease-out;
}

@keyframes timer-pulse {
    0% { transform: scale(1); }
    40% { transform: scale(1.08); }
    100% { transform: scale(1); }
}

.time-display--pulse {
    animation: timer-pulse 0.5s ease-out;
}

/* ── Session Dot Entrance ── */
@keyframes dot-enter {
    from {
        opacity: 0;
        transform: translateY(6px) scale(0.7);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

.session-dot--entering {
    animation: dot-enter 0.35s ease-out forwards;
}

/* ── Pause Breathing ── */
@keyframes pause-breathe {
    0%, 100% { opacity: 0.35; }
    50% { opacity: 0.48; }
}

@keyframes timer-breathe {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
}

.main--paused .time-display {
    animation: timer-breathe 3s ease-in-out infinite;
}

/* ── Timer Container ── */
.timer-container {
    padding: var(--space-xl);
    text-align: center;
    position: relative;
    z-index: 1;
}

/* ── Mode Themes ── */
#app[data-mode="work"] .app-title {
    color: var(--color-work);
}

#app[data-mode="break"] .app-title {
    color: var(--color-break);
}

#app[data-mode="work"] .time-display,
#app[data-mode="break"] .time-display {
    color: var(--color-on-fill);
    text-shadow: var(--shadow-timer);
}

/* ── Time Display ── */
.time-display {
    font-family: var(--font-mono);
    font-size: var(--text-timer);
    font-weight: var(--weight-bold);
    line-height: var(--leading-tight);
    color: var(--color-text);
    margin-bottom: var(--space-xl);
    transition: color 0.3s, text-shadow 0.3s, opacity 0.3s;
}


/* ── Buttons ── */
.btn {
    border: none;
    border-radius: var(--radius-md);
    padding: var(--space-sm) var(--space-lg);
    font-size: var(--text-base);
    font-weight: var(--weight-semibold);
    cursor: pointer;
    transition: background-color 0.2s, border-color 0.2s;
}

.btn-icon {
    width: 56px;
    height: 56px;
    border-radius: var(--radius-full);
    background: transparent;
    border: 1.5px solid var(--color-on-fill-muted);
    color: var(--color-on-fill-muted);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: var(--icon-md);
    padding: 0;
    transition: border-color 0.2s, color 0.2s;
}

/* Running state: subdued, brightens fully on hover */
.btn-icon:hover {
    border-color: var(--color-on-fill);
    color: var(--color-on-fill);
}

/* Paused state: icon prominent, border stays subtle */
.btn-icon--paused {
    color: var(--color-on-fill);
    border-color: var(--color-on-fill-muted);
}

.btn-icon--paused:hover {
    border-color: var(--color-on-fill-medium);
    color: var(--color-on-fill);
}

.btn-ghost {
    background: transparent;
    border: none;
    color: var(--color-text-muted);
    font-size: var(--text-sm);
    padding: var(--space-xs) var(--space-sm);
    transition: color 0.2s;
}

.btn-ghost:hover {
    color: var(--color-text);
}

.btn-ghost--danger:hover {
    color: var(--color-danger);
}

/* ── Settings Panel ── */
.settings-panel {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    z-index: 10;
    background-color: var(--color-overlay-bg);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border-bottom: 1px solid var(--color-overlay-border);
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
}

.settings-panel--open {
    max-height: 300px;
}

.settings-panel__inner {
    display: flex;
    align-items: center;
    justify-content: center;
    flex-wrap: wrap;
    gap: var(--space-md);
    padding: var(--space-md) var(--space-lg);
}

.settings-field {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
}

.settings-label {
    font-size: var(--text-sm);
    color: var(--color-text-muted);
    font-weight: var(--weight-medium);
    white-space: nowrap;
}

.settings-input {
    background: var(--color-surface-raised);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    color: var(--color-text);
    font-size: var(--text-base);
    padding: var(--space-sm) var(--space-md);
    outline: none;
    transition: border-color 0.2s;
    width: 72px;
}

.settings-input:focus {
    border-color: var(--color-border-focus);
}

/* ── Session History Dots ── */
.session-history {
    position: fixed;
    bottom: 28px;
    left: 0;
    right: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-wrap: wrap;
    gap: var(--space-sm);
    padding: var(--space-md) var(--space-lg) var(--space-md);
}

.session-dot {
    font-size: var(--icon-sm);
    flex-shrink: 0;
}

.session-dot--group-end {
    margin-right: var(--space-sm);
}

.session-dot--long-break {
    margin: 0 var(--space-sm);
}

.session-dot--work,
.session-dot--break {
    color: var(--color-on-fill-subtle);
}

#app[data-mode="work"] .session-dot--active,
#app[data-mode="break"] .session-dot--active {
    color: var(--color-on-fill);
    filter: var(--filter-dot-active);
}

/* ── Keyboard Coachmarks ── */
.coachmarks {
    position: fixed;
    bottom: 10px;
    display: flex;
    gap: var(--space-md);
    font-family: var(--font-body);
    font-size: var(--text-2xs);
    color: var(--color-hint);
    pointer-events: none;
    user-select: none;
}

.coachmarks--left {
    left: var(--space-lg);
}

.coachmarks--right {
    right: var(--space-lg);
}

.coachmarks kbd {
    font-family: inherit;
    font-weight: var(--weight-semibold);
    color: var(--color-hint-strong);
}

/* ── Confirm Modal ── */
.confirm-modal {
    display: none;
    position: fixed;
    inset: 0;
    z-index: 100;
    align-items: center;
    justify-content: center;
}

.confirm-modal--open {
    display: flex;
}

.confirm-modal__backdrop {
    position: absolute;
    inset: 0;
    background: rgba(var(--rgb-black), 0.5);
    backdrop-filter: blur(4px);
    -webkit-backdrop-filter: blur(4px);
}

.confirm-modal__dialog {
    position: relative;
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--space-lg);
    max-width: 340px;
    text-align: center;
}

.confirm-modal__message {
    font-size: var(--text-sm);
    color: var(--color-text-muted);
    margin: 0 0 var(--space-md);
    line-height: var(--leading-normal);
}

.confirm-modal__actions {
    display: flex;
    gap: var(--space-sm);
    justify-content: center;
}

/* ── Theme Toggle ── */
.btn-theme-toggle {
    font-size: var(--text-lg);
    display: inline-flex;
    align-items: center;
    justify-content: center;
}


/* ── Day Theme ── */
:root:has(#app[data-theme="day"]) {
    /* Primitive overrides */
    --gray-950: #f5f2ee;
    --gray-900: #ebe7e1;
    --gray-850: #e0dbd4;
    --gray-800: #d5d0c9;
    --gray-500: #7a7670;
    --gray-200: #2a2825;
    --amber-500: #c4822e;
    --amber-600: #a06a1e;
    --teal-500: #2a9d8f;
    --teal-600: #1e7568;
    --indigo-400: #5c6bc0;
    --indigo-600: #3f4fa0;
    --red-500: #c44422;
    --rgb-bg: 245, 242, 238;
    --rgb-amber-500: 196, 130, 46;
    --rgb-teal-500: 42, 157, 143;
    --rgb-red-500: 196, 68, 34;
    --rgb-green-500: 30, 117, 104;

    /* Semantic overrides (different alpha curves for dark-on-light) */
    --color-on-fill: rgba(var(--rgb-black), 0.75);
    --color-on-fill-medium: rgba(var(--rgb-black), 0.5);
    --color-on-fill-muted: rgba(var(--rgb-black), 0.25);
    --color-on-fill-subtle: rgba(var(--rgb-black), 0.25);
    --color-overlay-border: rgba(var(--rgb-black), 0.08);
    --color-hint: rgba(var(--rgb-black), 0.2);
    --color-hint-strong: rgba(var(--rgb-black), 0.3);
    --shadow-timer: 0 1px 8px rgba(var(--rgb-black), 0.1);
    --filter-dot-active: none;
}

#app[data-theme="day"] .main::before {
    background: linear-gradient(to bottom,
            color-mix(in srgb, var(--fill-color), white 15%) 0%,
            var(--fill-color) 40%,
            color-mix(in srgb, var(--fill-color), black 5%) 100%);
}